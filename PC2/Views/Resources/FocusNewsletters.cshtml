@model IEnumerable<PC2.Models.NewsletterFile>
@{
    ViewData["Title"] = "PC2 Focus Newsletters";
}

<div class="d-flex justify-content-center">
    <img src="~/images/resource-newsletters/newsletter1.jpg" />
    <img src="~/images/resource-newsletters/newsletter2.jpg" />
    <img src="~/images/resource-newsletters/newsletter3.jpg" />
    <img src="~/images/resource-newsletters/newsletter4.jpg" />
</div>
<br />
<h1>@ViewData["Title"]</h1>
<div class="divider"></div>
<br />
<p>PC2 publishes our "Focus" newsletter four times per year. All issues are available by visiting this page and clicking the links below.</p>
<br />
<p>If you'd like to get an email reminder when new issues are available, please send us a message at <a href="mailto:info@pc2online.org">info@pc2online.org</a>. </p>
<br />

@if (Model.Any())
{
    <div class="row g-4">
        @for (int i = Model.Count() - 1; i >= 0; i--) // Loop backwards so newest newsletters appear first
        {
            <div class="col-12 col-lg-8 mx-lg-auto">
                <div class="card h-100 shadow-sm">
                    <div class="card-body d-flex flex-column">
                        <div class="d-flex align-items-center mb-3 min-width-0">
                            <i class="bi bi-file-earmark-pdf text-danger me-3 fs-1" aria-hidden="true"></i>
                            <div class="flex-grow-1">
                                <h5 class="card-title mb-1 text-primary">@Model.ElementAt(i).Name</h5>
                                <small class="text-muted">PDF Newsletter</small>
                            </div>
                        </div>
                        <div class="mt-auto">
                            <a href="@Model.ElementAt(i).Location" 
                               target="_blank" 
                               class="btn btn-primary text-white w-100 d-flex align-items-center justify-content-center"
                               onclick="trackExternalLink(this.href); return false;"
                               aria-label="Download @Model.ElementAt(i).Name PDF">
                                <i class="bi bi-download me-2" aria-hidden="true"></i>
                                Download PDF
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>
}
else
{
    <div class="alert alert-info text-center">
        <i class="bi bi-info-circle me-2" aria-hidden="true"></i>
        No newsletters are currently available. Please check back later.
    </div>
}

@section Scripts
{
    <script>
        function trackExternalLink(url) {
            appInsights.trackEvent({
                name: "FocusNewsletter",
                properties: {
                    linkUrl: url,
                    SearchType: "Download"
                }
            });
            window.open(url);
        }
    </script>
}